{% extends 'base.html' %}

{% block title %}
Order List
{% endblock title %}

{% block content %}
<section class="section">
  <div class="container">
    <h2 class="title has-text-centered">Order List</h2>
    <p class="has-text-centered">
      Each order is associated with one or more samples. The MIxS standard for each sample can be defined in the "Metadata" column. The corresponding MIxS standard questionnaire fields will appear in the "Samples" column.
    </p>
    {% if orders %}
      <div class="table-container">
        <table class="table is-bordered is-striped is-narrow is-hoverable is-fullwidth">
          <thead>
            <tr>
              <th>Order ID</th>
              <th>Order Actions</th>
              <th>Metadata</th>
              <th>Samples</th>
            </tr>
          </thead>
          <tbody>
            {% for order in orders %}
              <tr>
                <td>{{ order.id }}</td>
                <td>
                  <div class="buttons">
                    <a href="{% url 'order_edit' project_id=project_id order_id=order.id %}" class="button is-small is-info">Edit</a>
                    <a class="button is-small is-danger" onclick="deleteOrder('{% url 'delete_order' project_id=project_id order_id=order.id %}')">Delete</a>
                  </div>
                </td>
                <td>
                  <a href="{% url 'metadata_view' project_id=project_id order_id=order.id %}" class="button is-small is-primary">Checklists</a>
                </td>
                <td>
                  <a href="{% url 'samples_view' project_id=project_id order_id=order.id %}" class="button is-small is-primary">Edit Samples</a>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <p class="has-text-centered">No orders found.</p>
    {% endif %}

    <div class="has-text-centered mt-4">
        <a href="{% url 'order_create' project_id %}" class="button is-primary">Request new order</a>
        <a href="{% url 'project_list' %}" class="button is-link is-light">Back to projects</a>
  </div>

</section>

<script>
function deleteOrder(url, orderId) {
      if (confirm('Are you sure you want to delete this order?')) {
        window.location.href = url;
      }
  }

</script>
{% endblock content %}